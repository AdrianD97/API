<html>
	<head>
		<title></title>
		<style type="text/css">
			table, th, td {
				border: 1px solid black;
			}
		</style>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<script type="text/javascript">
			function create_student() {
				/*TODO:
					daca se da click pe butonul Add, atunci va aparea formularul(care este hidden initial, necompletat).
					Cand da submit apelam o metoda care sa faca ajax requestul de create
					(method: POST) si de asemnea facem refresh la pagina
				*/
			}

			function edit_student(studentId) {
				// TODO:
				/*
					Facem ajax requestul care ne da informatiile pentru studentul
					cu studentId id.
					Completam formularul(deci acesta va deveni vizibil) cu datele initiale 
					ale studentului din pagina
					iar cand va apasa pe butonul de submit vom apela o functie care
					face ajax requestul de update(method: PUT) si de asemenea vom face 
					refresh la pagina pentru a vedea modificarile in tabel.
				*/
				console.log("Edit student with id " + studentId);
			}

			function delete_student(studentId) {
				console.log("Delete student with id " + studentId);
				$.ajax({
				  	method: "DELETE",
				   	url: "http://localhost:8080/students/delete/" + studentId,
				   	success: function(response) {
				   		console.log(response);
				   		location.reload();
				   	},
				   	error: function(err) {
				   		console.log(error);
				   	}
				});
			}

			function delete_all_students() {
				/*
				cand se da click pe butonul Delete All, se va apela aceasta functie care
				va face ajax requestul de stergere a tuturor studentilor
				(method: DELETE), si bine inteles vom face refresh la pagina
				*/
			}

			function fetch_students() {
			  	$.ajax({
				  	method: "GET",
				   	url: "http://localhost:8080/students/list/",
				   	success: function(data) {
				    	let content = "";

				    	$.each(data, function(index, item) {
				    		const id = JSON.stringify(item._id);

					        content += "<tr>" +
					        		   "<td>" + (index + 1) + "</td>" +
					        		   "<td>" + item.name + "</td>" +
					        		   "<td>" + item.age + "</td>" +
					        		   "<td>" + item.faculty + "</td>" +
					        		   "<td>" + item.email + "</td>" +
					        		   "<td>" +
					        		   "<button onclick='edit_student(" + id +
					        		   				")'>Edit</button>" +
					        		   "<button onclick='delete_student(" + id +
					        		   				")'>Delete</button>" +
					        		   "</td>" +
					        		   "</tr>";
					    });
				    	
				    	$("tbody").html(content);
				    },
				    error: function(error) {
			            console.log(error);
			        }
				});
		 	}

			$(document).ready(function() {
				fetch_students();
			});
		</script>
	</head>
	<body>
		<table>
			<thead>
				<tr>
					<th>Id</th>
					<th>Name</th>
					<th>Age</th>
					<th>Faculty</th>
					<th>Email</th>
					<th>Options</th>
				</tr>
			</thead>
	    	<tbody></tbody>
	    </table>

	    <!-- TODO:
	    1. button with Add label. cand este apasat va aparea formularul  
		2. button Delete All. cand este apasat se va apela delete_all_students 
		3. cand se apasa Edit  va aparea formularul precompletat cu datele respectivlui
			student pentru a putea fi editate
		4. un button Chat care in momentul in care este apasat va redirecta userul
		pe pagina de chat(pagina este pe branch-ul chat_branch)
		-->


		<!-- Aici va fi un form, care initila va fi hidden--> 
	</body>
</html>